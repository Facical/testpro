<Window x:Class="testpro.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:testpro"
        xmlns:views="clr-namespace:testpro.Views"
        xmlns:converters="clr-namespace:testpro.Converters"
        Title="Smart Shelf Visualizer" 
        Height="800" 
        Width="1200"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
        <converters:ViewModeToVisibilityConverter x:Key="ViewModeToVisibilityConverter"/>
        <converters:BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 메뉴 -->
        <Menu Grid.Row="0">
            <MenuItem Header="파일">
                <MenuItem Header="새 프로젝트" Click="NewProject_Click"/>
                <MenuItem Header="열기..." Click="OpenProject_Click"/>
                <MenuItem Header="저장" Click="SaveProject_Click"/>
                <Separator/>
                <MenuItem Header="종료" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="편집">
                <MenuItem Header="실행 취소" Command="Undo"/>
                <MenuItem Header="다시 실행" Command="Redo"/>
            </MenuItem>
            <MenuItem Header="보기">
                <MenuItem Header="2D 모드" IsCheckable="True" IsChecked="{Binding Is2DMode}"/>
                <MenuItem Header="3D 모드" IsCheckable="True" IsChecked="{Binding Is3DMode}"/>
            </MenuItem>
        </Menu>

        <!-- 도구 모음 -->
        <ToolBar x:Name="MainToolBar" Grid.Row="1">
            <Button Content="선택" Click="SelectTool_Click" Margin="2"/>
            <Separator/>
            <ToggleButton x:Name="DrawModeButton" Content="그리기 모드" IsChecked="True" Click="DrawModeButton_Click" Margin="2"/>
            <ToggleButton x:Name="LoadModeButton" Content="도면 모드" Click="LoadModeButton_Click" Margin="2"/>
            <Separator/>

            <!-- 그리기 모드 패널 -->
            <StackPanel x:Name="DrawingModePanel" Orientation="Horizontal">
                <Button Content="벽 그리기" Click="WallTool_Click" Margin="2"/>
                <Separator/>
                <Button Content="냉장고" Click="PlaceRefrigerator_Click" Margin="2"/>
                <Button Content="선반" Click="PlaceShelf_Click" Margin="2"/>
                <Button Content="계산대" Click="PlaceCheckout_Click" Margin="2"/>
            </StackPanel>

            <!-- 도면 모드 패널 -->
            <StackPanel x:Name="LoadingModePanel" Orientation="Horizontal" Visibility="Collapsed">
                <Button Content="도면 불러오기" Click="LoadFloorPlan_Click" Margin="2"/>
                <Button Content="객체 감지" Click="DetectObjects_Click" Margin="2"/>
                <TextBlock Text="감지된 객체:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                <TextBlock x:Name="DetectedObjectsCountText" Text="0개" VerticalAlignment="Center" FontWeight="Bold"/>
            </StackPanel>
        </ToolBar>

        <!-- 메인 컨텐츠 -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- 2D/3D 뷰 -->
            <TabControl Grid.Column="0">
                <TabItem Header="2D 편집">
                    <views:DrawingCanvas x:Name="DrawingCanvasControl"/>
                </TabItem>
                <TabItem Header="3D 시각화">
                    <views:Viewer3D x:Name="Viewer3DControl"/>
                </TabItem>
            </TabControl>

            <!-- 속성 패널 -->
            <Border Grid.Column="1" BorderBrush="Gray" BorderThickness="1,0,0,0">
                <ScrollViewer>
                    <StackPanel Margin="10">
                        <TextBlock Text="속성" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                        <!-- 선택된 객체 정보 -->
                        <GroupBox Header="선택된 객체" Margin="0,0,0,10">
                            <StackPanel>
                                <TextBlock Text="{Binding SelectedObject.GetDisplayName, FallbackValue='없음'}"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- 통계 -->
                        <GroupBox Header="통계" Margin="0,0,0,10">
                            <TextBlock x:Name="StatisticsText" TextWrapping="Wrap"/>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- 상태 표시줄 -->
        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusText}"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Text="{Binding PerformanceInfo}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>